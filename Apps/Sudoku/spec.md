# 🧩 ナンプレアプリ仕様書 (Sudoku Single-File App)

**バージョン:** 1.6.0 (Logic Engine Upgrade / Local Edition)
**最終更新日:** 2025年12月30日
**ターゲット:** シニア層（視覚過敏・手術後対応）およびパズル愛好家
**開発手法:** SpriteSystem Hybrid Workflow (Flash & Pro)

---

## 1. プロジェクト概要
本アプリは「インストール不要・通信不要・ストレスフリー」を掲げる、シニア特化型のナンプレアプリです。
v1.6.0では、パズル雑誌品質の「論理的思考で解ける良問」を生成する新エンジンを搭載し、難易度判定の厳密化を行いました。

### 🛠 開発ハイライト
1. **Phase 1: Architecture (Flash):** 高速なプロトタイプ構築とシニア向け配色（アイボリー基調）の策定。
2. **Phase 2: Logic Design (Pro):** ビット演算による高速エンジンと、人間的な解法アルゴリズムの生成。
3. **Phase 3: Final Polish (Human):** 実機テストに基づくレスポンシブ微調整と、家族向けイースターエッグの統合。

---

## 2. 技術仕様 (Technical Stack)

### アーキテクチャ
* **言語:** HTML5, CSS3, JavaScript (ES2020+)
* **ファイル構成:** 1ファイル (index.html) に全てを内包。
* **通信機能:** なし。サーバーや外部ファイルに一切依存しない完全単体動作モデル。

### データ保存 (LocalStorage)
* **Key:** seniorSudokuApp_v5_local
* **保存内容:**
    * puzzle: 現在の盤面状態
    * memos: メモ書きの状態
    * fixed: 初期配置フラグ
    * solution: 正解データ
    * isComplete: クリア状態フラグ
    * diffKey: 選択中の難易度
* **特記事項:** ローカルファイル実行（file://）の場合でも動作するよう設計。

---

## 3. UI/UX仕様 (Design System)

### 配色 (Color Palette)
視覚負担を最小限に抑えるため、以下のカラーコードを厳守すること。

| 用途 | 色名 | コード | 備考 |
| :--- | :--- | :--- | :--- |
| **背景** | Ivory | #F5F5DC | 純白は禁止（ハレーション防止）。 |
| **文字** | Dark Navy | #000033 | 黒よりも柔らかく、視認性が高い。 |
| **エラー** | Red | #D00000 | 即時判定用。誤入力した数字に使用。 |
| **選択セル** | Pale Yellow | #FFFFA0 | 選択中のマス。 |
| **十字強調** | Greige | #E0E0C8 | クロスハイライト。視認性を強化。 |
| **枠線** | Dark Gray | #555555 | 3x3ブロック境界線は 4px で強調。 |

### タイポグラフィ
* **フォント:** "Hiragino Sans", "Meiryo", sans-serif
* **ウェイト設定:**
    * **固定数字:** 900 (極太)
    * **入力数字:** bold (700相当)

---

## 4. エンジン仕様 (Logic & Difficulty)

### 生成アルゴリズム (v1.6.0 新実装)
従来の「穴数ベース」から、「人間的思考シミュレータ（Human-Like Solver）」を用いた論理判定ベースへ移行。
* **Bitmask 判定:** Int16Array とビット演算を使用して重複判定を高速化。
* **安全装置:** 生成処理に 2000ms のタイムアウトを設定。ブラウザのフリーズを完全防止。

### 難易度定義 (Logic Levels)

| 難易度 | 穴数目安 | 必須/許容ロジック (Logic Check) | 特徴 |
| :--- | :--- | :--- | :--- |
| **⭐ かんたん** | 36 | **Naked Single** | 候補が1つしかないマスを埋めるだけで解ける問題を保証。 |
| **⭐⭐ ふつう** | 46 | **Hidden Single** | 「この列で1が入れるのはここだけ」等の推論が必要。 |
| **⭐⭐⭐ むずかしい**| 54 | **X-Wing** 等 | 高等テクニックが必要になる可能性がある盤面を生成。 |
| **👑 達人** | 62 | **Logic Check Skip** | 手筋制限なし。ヒント数が極限まで少ない。 |

---

## 5. 機能詳細

### スマート操作
* **リアルタイム判定:** 数字入力時、即座に正解データと比較を行い、不一致なら赤字で表示。
* **アニメーション:** 固定マスをタップした際、左右に揺れる（Shake）アニメーションを再生。
* **スマートメモ消去:** 数字を確定入力すると、関連する行・列・ブロック内の同じ数字のメモを自動削除。

### 隠し機能 (Easter Egg)
* **誕生日メッセージ:** 2月20日に起動した際、初回のみお祝いダイアログを表示する。

---

## 6. 運用・保守ガイド

1. **配布方法:** index.html を 1 ファイルのみ送信。
2. **バージョン管理:** CONFIG.VERSION 定数で管理。
3. **アクセシビリティ:** 配色の変更時は、シニアユーザーの視認性（アイボリー背景の維持）を最優先すること。
